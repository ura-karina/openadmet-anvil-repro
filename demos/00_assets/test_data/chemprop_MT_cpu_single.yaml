data:
  type: intake
  cat_entry: null
  input_col: OPENADMET_SMILES
  resource: "{{ANVIL_DIR}}/cyp_multitask.csv"
  target_cols:
  - cyp3a4_pchembl_value_mean
  - cyp2d6_pchembl_value_mean
  - cyp2c9_pchembl_value_mean
  - cyp1a2_pchembl_value_mean

metadata:
  authors: Hugo M-O
  biotargets:
  - CYP3A4
  - CYP2D6
  - CYP2C9
  - CYP1A2
  build_number: 0
  description: basic regression  using a ChemProp multitask task model
  driver: pytorch
  email: hugo.macdermott-opeskin@omsf.io
  name: chemprop_MT_pchembl_testing_chemprop
  tag: openadmet-CYP3A4-pchembl-regression-testing-cv
  tags:
  - openadmet
  - test
  - pchembl
  version: v1

procedure:
  feat:
    type: ChemPropFeaturizer
    params: {}

  model:
    type: ChemPropModel
    params:
      messages: bond
      n_tasks: 4

  split:
    type: ShuffleSplitter
    params:
      random_state: 42
      test_size: 0.2
      train_size: 0.7
      val_size: 0.1

  train:
    type: LightningTrainer
    params:
      accelerator: cpu
      max_epochs: 1
      use_wandb: false

report:
  eval:
  - type: RegressionMetrics
    params: {}

  - type: RegressionPlots
    params:
      axes_labels:
      - True pChEMBL
      - Predicted pChEMBL
      max_val: 10
      min_val: 3
      pXC50: true
      title: Multitask True vs Predicted pChEMBL on test set

  - type: PytorchLightningRepeatedKFoldCrossValidation
    params:
      axes_labels:
      - True pChEMBL
      - Predicted pChEMBL
      n_repeats: 2
      n_splits: 5
      pXC50: true
      random_state: 42
      title: Multitask True vs Predicted pChEMBL on test
